openapi: 3.0.3
info:
  title: Inventory Service API
  description: Inventory and items management
  version: 1.0.0

servers:
  - url: http://localhost:3004/api

tags:
  - name: Inventory

paths:

  /inventory:
    post:
      tags: [Inventory]
      summary: Create inventory for hero
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateInventoryRequest'
      responses:
        201:
          description: Inventory created

  /inventory/{heroId}:
    get:
      tags: [Inventory]
      summary: Get hero inventory
      parameters:
        - $ref: '#/components/parameters/HeroId'
      responses:
        200:
          description: Inventory
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Inventory'
    put:
      tags: [Inventory]
      summary: Update entire hero inventory
      parameters:
        - $ref: '#/components/parameters/HeroId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateInventoryRequest'
      responses:
        200:
          description: Inventory updated
    delete:
      tags: [Inventory]
      summary: Delete hero inventory
      parameters:
        - $ref: '#/components/parameters/HeroId'
      responses:
        204:
          description: Inventory deleted

  /inventory/{heroId}/equipped_artifacts:
    get:
      tags: [Inventory]
      summary: Get hero equipped artifacts
      parameters:
        - $ref: '#/components/parameters/HeroId'
      responses:
        200:
          description: Equipped artifacts
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EquippedArtifacts'

  /inventory/{heroId}/upgrade-info/{artifactId}:
    get:
      tags: [Inventory]
      summary: Get artifact upgrade cost and info
      parameters:
        - $ref: '#/components/parameters/HeroId'
        - name: artifactId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        200:
          description: Upgrade cost information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpgradeInfo'
        404:
          description: Artifact or inventory not found

  /inventory/{heroId}/upgrade/{artifactId}:
    post:
      tags: [Inventory]
      summary: Upgrade an artifact with gold
      parameters:
        - $ref: '#/components/parameters/HeroId'
        - name: artifactId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        200:
          description: Artifact upgraded successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpgradeResponse'
        400:
          description: Cannot upgrade (insufficient gold or max level reached)
        404:
          description: Artifact or inventory not found

components:

  parameters:
    HeroId:
      name: heroId
      in: path
      required: true
      schema:
        type: string
        format: uuid

  schemas:

    Inventory:
      type: object
      properties:
        gold:
          type: integer
        equippedCount:
          type: integer
        items:
          type: array
          items:
            $ref: '#/components/schemas/InventoryItem'

    InventoryItem:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: UUID of the inventory item
        artifactId:
          type: string
          format: uuid
          description: UUID of the artifact
        equipped:
          type: boolean
        upgradeLevel:
          type: integer
          description: Upgrade level of the item (allows multiple copies of same artifact)

    CreateInventoryRequest:
      type: object
      properties:
        heroId:
          type: string
          format: uuid
        gold:
          type: integer

    UpdateInventoryRequest:
      type: object
      properties:
        heroId:
          type: string
          format: uuid
        gold:
          type: integer
        items:
          type: array
          items:
            $ref: '#/components/schemas/InventoryItem'

    EquippedArtifacts:
      type: object
      properties:
        equippedCount:
          type: integer
          description: Total count of equipped artifacts
        items:
          type: array
          description: List of equipped artifact items
          items:
            type: object
            properties:
              artifactId:
                type: string
                format: uuid
                description: UUID of the artifact
              upgradeLevel:
                type: integer
                description: Upgrade level of the equipped item
    UpgradeInfo:
      type: object
      properties:
        artifactId:
          type: string
          format: uuid
        name:
          type: string
          description: Name of the artifact
        currentLevel:
          type: integer
          description: Current upgrade level
        nextLevel:
          type: integer
          description: Next upgrade level
        maxLevel:
          type: integer
          description: Maximum upgrade level (10)
        baseLevel:
          type: integer
          description: Base level of the artifact
        nextUpgradeCost:
          type: integer
          description: Cost in gold for next upgrade
        currentGold:
          type: integer
          description: Current gold in inventory
        canUpgrade:
          type: boolean
          description: Whether the hero can upgrade this artifact
        reason:
          type: string
          nullable: true
          description: Reason why upgrade is not possible

    UpgradeResponse:
      type: object
      properties:
        message:
          type: string
        artifact:
          type: string
          description: Name of the upgraded artifact
        newUpgradeLevel:
          type: integer
          description: New upgrade level
        costPaid:
          type: integer
          description: Gold spent on upgrade
        remainingGold:
          type: integer
          description: Gold remaining after upgrade